Test git rev: a2df3397a7f5ead5a7a22176b5c8a784f05d01a8
PASS tests/unit/lib/storage/claude-settings.test.js
PASS tests/unit/lib/commands/view.test.js
  ● Console

    console.log
      
      Discovered Claude Code Plugins in /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-view-test-BBaUMH

      at log (../src/lib/commands/view.js:44:11)

PASS tests/unit/lib/commands/sync.test.js
PASS tests/unit/lib/scanner.test.js
  ● Console

    console.warn
      Malformed JSON in /private/var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-scanner-test-PTLcu7/node_modules/bad-plugin/.claude-plugin/marketplace.json: Expected property name or '}' in JSON at position 1 (line 1 column 2)

      30 |     if (error instanceof SyntaxError) {
      31 |       // eslint-disable-next-line no-console
    > 32 |       console.warn(`Malformed JSON in ${filePath}: ${error.message}`)
         |               ^
      33 |
      34 |       return null
      35 |     }

      at warn (../src/lib/parsers/marketplace-json.js:32:15)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid marketplace.json at /private/var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-scanner-test-63CTfP/node_modules/invalid-plugin/.claude-plugin/marketplace.json: missing required fields

      19 |
      20 |     // eslint-disable-next-line no-console
    > 21 |     console.warn(`Invalid marketplace.json at ${filePath}: missing required fields`)
         |             ^
      22 |
      23 |     return null
      24 |   }

      at warn (../src/lib/parsers/marketplace-json.js:21:13)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

PASS tests/unit/lib/parsers/marketplace-json.test.js
  ● Console

    console.warn
      Invalid skillPath: must be relative and within package

      59 |   if (data.skillPath.includes('..') || path.isAbsolute(data.skillPath)) {
      60 |     // eslint-disable-next-line no-console
    > 61 |     console.warn('Invalid skillPath: must be relative and within package')
         |             ^
      62 |
      63 |     return false
      64 |   }

      at warn (../src/lib/parsers/marketplace-json.js:61:13)
      at Object.<anonymous> (../tests/unit/lib/parsers/marketplace-json.test.js:100:37)

    console.warn
      Invalid skillPath: must be relative and within package

      59 |   if (data.skillPath.includes('..') || path.isAbsolute(data.skillPath)) {
      60 |     // eslint-disable-next-line no-console
    > 61 |     console.warn('Invalid skillPath: must be relative and within package')
         |             ^
      62 |
      63 |     return false
      64 |   }

      at warn (../src/lib/parsers/marketplace-json.js:61:13)
      at Object.<anonymous> (../tests/unit/lib/parsers/marketplace-json.test.js:110:37)

    console.warn
      Malformed JSON in /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-75JxKa/bad.json: Expected property name or '}' in JSON at position 1 (line 1 column 2)

      30 |     if (error instanceof SyntaxError) {
      31 |       // eslint-disable-next-line no-console
    > 32 |       console.warn(`Malformed JSON in ${filePath}: ${error.message}`)
         |               ^
      33 |
      34 |       return null
      35 |     }

      at warn (../src/lib/parsers/marketplace-json.js:32:15)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid marketplace.json at /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-Y9F7Lz/invalid.json: missing required fields

      19 |
      20 |     // eslint-disable-next-line no-console
    > 21 |     console.warn(`Invalid marketplace.json at ${filePath}: missing required fields`)
         |             ^
      22 |
      23 |     return null
      24 |   }

      at warn (../src/lib/parsers/marketplace-json.js:21:13)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid skillPath: must be relative and within package

      59 |   if (data.skillPath.includes('..') || path.isAbsolute(data.skillPath)) {
      60 |     // eslint-disable-next-line no-console
    > 61 |     console.warn('Invalid skillPath: must be relative and within package')
         |             ^
      62 |
      63 |     return false
      64 |   }

      at warn (../src/lib/parsers/marketplace-json.js:61:13)
      at validateMarketplaceJson (../src/lib/parsers/marketplace-json.js:16:9)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid marketplace.json at /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-dZfqr7/evil.json: missing required fields

      19 |
      20 |     // eslint-disable-next-line no-console
    > 21 |     console.warn(`Invalid marketplace.json at ${filePath}: missing required fields`)
         |             ^
      22 |
      23 |     return null
      24 |   }

      at warn (../src/lib/parsers/marketplace-json.js:21:13)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid skillPath: must be relative and within package

      59 |   if (data.skillPath.includes('..') || path.isAbsolute(data.skillPath)) {
      60 |     // eslint-disable-next-line no-console
    > 61 |     console.warn('Invalid skillPath: must be relative and within package')
         |             ^
      62 |
      63 |     return false
      64 |   }

      at warn (../src/lib/parsers/marketplace-json.js:61:13)
      at validateMarketplaceJson (../src/lib/parsers/marketplace-json.js:16:9)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Invalid marketplace.json at /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-lSiri0/absolute.json: missing required fields

      19 |
      20 |     // eslint-disable-next-line no-console
    > 21 |     console.warn(`Invalid marketplace.json at ${filePath}: missing required fields`)
         |             ^
      22 |
      23 |     return null
      24 |   }

      at warn (../src/lib/parsers/marketplace-json.js:21:13)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Malformed JSON in /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-4f85XO/empty.json: Unexpected end of JSON input

      30 |     if (error instanceof SyntaxError) {
      31 |       // eslint-disable-next-line no-console
    > 32 |       console.warn(`Malformed JSON in ${filePath}: ${error.message}`)
         |               ^
      33 |
      34 |       return null
      35 |     }

      at warn (../src/lib/parsers/marketplace-json.js:32:15)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

    console.warn
      Malformed JSON in /var/folders/b_/cqvmw4wd3p97n3h4qh85kb1c0000gp/T/air-test-Opt1Sp/whitespace.json: Unexpected end of JSON input

      30 |     if (error instanceof SyntaxError) {
      31 |       // eslint-disable-next-line no-console
    > 32 |       console.warn(`Malformed JSON in ${filePath}: ${error.message}`)
         |               ^
      33 |
      34 |       return null
      35 |     }

      at warn (../src/lib/parsers/marketplace-json.js:32:15)
      at ../node_modules/@babel/runtime/helpers/regeneratorRuntime.js:52:18
      at Generator.<anonymous> (../node_modules/@babel/runtime/helpers/regenerator.js:52:51)
      at Generator.next (../node_modules/@babel/runtime/helpers/regeneratorDefine.js:11:21)
      at asyncGeneratorStep (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:17)
      at _next (../node_modules/@babel/runtime/helpers/asyncToGenerator.js:17:9)

PASS tests/unit/lib/types.test.js
PASS tests/unit/lib/utils/parse-library-integration.test.js
-------------------------------|---------|----------|---------|---------|----------------------
File                           | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s    
-------------------------------|---------|----------|---------|---------|----------------------
All files                      |    53.9 |    48.11 |   42.78 |   53.87 |                      
 src/cli                       |       0 |        0 |       0 |       0 |                      
  air.mjs                      |       0 |        0 |       0 |       0 | 1-25                 
 src/lib                       |   75.72 |    73.86 |   53.84 |   73.91 |                      
  scanner.js                   |   72.41 |    56.86 |   47.82 |   67.92 | 21-62,151            
  types.js                     |   93.75 |    97.29 |     100 |   93.75 | 167                  
 src/lib/commands              |   96.05 |    74.45 |     100 |   95.23 |                      
  sync.js                      |   90.19 |    65.62 |     100 |   88.23 | 45,65,70-71          
  view.js                      |      99 |    82.19 |     100 |   98.59 | 149                  
 src/lib/parsers               |   94.87 |    65.78 |     100 |   92.59 |                      
  marketplace-json.js          |   94.87 |    65.78 |     100 |   92.59 | 30,34                
 src/lib/storage               |    91.3 |    74.33 |   91.17 |   89.58 |                      
  claude-config.js             |   76.92 |    66.66 |   57.14 |      75 | 23-31,47             
  claude-settings.js           |    92.8 |    74.76 |     100 |   91.66 | 60,71,90,173,210-213 
 src/lib/utils                 |     100 |      100 |     100 |     100 |                      
  parse-library-integration.js |     100 |      100 |     100 |     100 |                      
 tests/functional              |       0 |        0 |       0 |       0 |                      
  helpers.js                   |       0 |        0 |       0 |       0 | 5-196                
 tests/integration             |       0 |        0 |       0 |       0 |                      
  test-helpers.js              |       0 |        0 |       0 |       0 | 5-453                
 tests/unit/lib                |   93.47 |    57.14 |     100 |   92.59 |                      
  test-lib.js                  |   93.47 |    57.14 |     100 |   92.59 | 16,68                
-------------------------------|---------|----------|---------|---------|----------------------

Test Suites: 7 passed, 7 total
Tests:       107 passed, 107 total
Snapshots:   0 total
Time:        0.38 s, estimated 1 s
Ran all test suites matching test-staging/tests/unit/.
